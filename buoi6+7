<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quản lý Học viên</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(to right, #f3f4f7, #dfefff);
    }

    .card {
      border-radius: 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.1);
    }

    .btn-gradient {
      background: linear-gradient(45deg, #f093fb, #f5576c);
      border: none;
      color: white;
    }

    .btn-gradient:hover {
      background: linear-gradient(45deg, #36d1dc, #5b86e5);
    }

    .card-header {
      border-radius: 16px 16px 0 0;
    }

    #notification-area {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
    }
  </style>
</head>
<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
    <div class="container justify-content-center">
      <a class="navbar-brand fw-bold" href="#">Quản lý Học viên</a>
    </div>
  </nav>

  <main class="container mt-4">
    <div class="row">
      <!-- Form -->
      <div class="col-lg-5 mb-4">
        <div class="card">
          <div class="card-header bg-dark text-white">
            <h5 id="form-title" class="mb-0">Thêm Học viên</h5>
          </div>
          <div class="card-body">
            <form id="studentForm">
              <div class="mb-3">
                <label for="mahv" class="form-label">Mã học viên:</label>
                <input type="text" class="form-control" id="mahv" name="mahv">
              </div>
              <div class="mb-3">
                <label for="tenhv" class="form-label">Họ tên học viên:</label>
                <input type="text" class="form-control" id="tenhv" name="tenhv">
              </div>
              <div class="mb-3">
                <label for="lienhe" class="form-label">Liên hệ (Email):</label>
                <input type="email" class="form-control" id="lienhe" name="lienhe">
              </div>
              <div class="mb-3">
                <label class="form-label">Giới tính:</label><br />
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="gioitinh" id="nam" value="Nam" checked>
                  <label class="form-check-label" for="nam">Nam</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="gioitinh" id="nu" value="Nữ">
                  <label class="form-check-label" for="nu">Nữ</label>
                </div>
              </div>
              <button type="submit" id="submitBtn" class="btn btn-gradient w-100 fw-bold">Thêm học viên</button>
            </form>
          </div>
        </div>
      </div>

      <!-- Danh sách -->
      <div class="col-lg-7">
        <div class="card">
          <div class="card-header bg-light">
            <h5 class="mb-0">Danh sách học viên</h5>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-striped table-hover mb-0">
                <thead class="table-dark text-center">
                  <tr>
                    <th>STT</th>
                    <th>Mã HV</th>
                    <th>Họ tên</th>
                    <th>Email</th>
                    <th>Giới tính</th>
                    <th>Chức năng</th>
                  </tr>
                </thead>
                <tbody id="studentList" class="text-center">
                  <tr>
                    <td>1</td>
                    <td>HV101</td>
                    <td>Phạm Anh Quân</td>
                    <td>quana@example.com</td>
                    <td>Nam</td>
                    <td>
                      <button class="btn btn-success btn-sm" onclick="editStudent(this)">Sửa</button>
                      <button class="btn btn-danger btn-sm" onclick="deleteStudent(this)">Xoá</button>
                    </td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>HV102</td>
                    <td>Đặng Thị Ngọc</td>
                    <td>ngocdt@example.com</td>
                    <td>Nữ</td>
                    <td>
                      <button class="btn btn-success btn-sm" onclick="editStudent(this)">Sửa</button>
                      <button class="btn btn-danger btn-sm" onclick="deleteStudent(this)">Xoá</button>
                    </td>
                  </tr>
                  <tr>
                    <td>3</td>
                    <td>HV103</td>
                    <td>Ngô Minh Khôi</td>
                    <td>khoi.ngo@example.com</td>
                    <td>Nam</td>
                    <td>
                      <button class="btn btn-success btn-sm" onclick="editStudent(this)">Sửa</button>
                      <button class="btn btn-danger btn-sm" onclick="deleteStudent(this)">Xoá</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <div id="notification-area"></div>

  <script>
    let selectedRow = null;

    document.getElementById('studentForm').addEventListener('submit', function (e) {
      e.preventDefault();
      const mahv = document.getElementById('mahv').value;
      const tenhv = document.getElementById('tenhv').value;
      const lienhe = document.getElementById('lienhe').value;
      const gioitinh = document.querySelector('input[name="gioitinh"]:checked').value;

      if (!validateInput(mahv, tenhv, lienhe)) return;

      if (selectedRow === null) {
        const newRow = document.getElementById('studentList').insertRow();
        newRow.innerHTML = `
          <td></td>
          <td>${mahv}</td>
          <td>${tenhv}</td>
          <td>${lienhe}</td>
          <td>${gioitinh}</td>
          <td>
            <button class="btn btn-success btn-sm" onclick="editStudent(this)">Sửa</button>
            <button class="btn btn-danger btn-sm" onclick="deleteStudent(this)">Xoá</button>
          </td>
        `;
        showNotification('Thêm học viên thành công!', 'success');
      } else {
        selectedRow.cells[1].innerText = mahv;
        selectedRow.cells[2].innerText = tenhv;
        selectedRow.cells[3].innerText = lienhe;
        selectedRow.cells[4].innerText = gioitinh;
        showNotification('Cập nhật thông tin thành công!', 'info');
        resetFormState();
      }

      updateRowNumbers();
      document.getElementById('studentForm').reset();
    });

    function validateInput(m, t, e) {
      if (m.trim() === '' || t.trim() === '' || e.trim() === '') {
        showNotification('Vui lòng điền đầy đủ thông tin.', 'warning');
        return false;
      }
      const emailRegex = /^\S+@\S+\.\S+$/;
      if (!emailRegex.test(e)) {
        showNotification('Email không hợp lệ.', 'warning');
        return false;
      }
      return true;
    }

    function editStudent(btn) {
      selectedRow = btn.parentElement.parentElement;
      document.getElementById('mahv').value = selectedRow.cells[1].innerText;
      document.getElementById('tenhv').value = selectedRow.cells[2].innerText;
      document.getElementById('lienhe').value = selectedRow.cells[3].innerText;
      document.getElementById(selectedRow.cells[4].innerText === 'Nam' ? 'nam' : 'nu').checked = true;
      document.getElementById('submitBtn').innerText = 'Cập nhật';
      document.getElementById('form-title').innerText = 'Cập nhật Học viên';
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function deleteStudent(btn) {
      if (confirm('Bạn chắc chắn muốn xóa học viên này?')) {
        const row = btn.parentElement.parentElement;
        if (selectedRow === row) {
          resetFormState();
          document.getElementById('studentForm').reset();
        }
        row.remove();
        updateRowNumbers();
        showNotification('Đã xoá học viên thành công!', 'danger');
      }
    }

    function updateRowNumbers() {
      const rows = document.querySelectorAll('#studentList tr');
      rows.forEach((row, index) => {
        row.cells[0].innerText = index + 1;
      });
    }

    function resetFormState() {
      selectedRow = null;
      document.getElementById('submitBtn').innerText = 'Thêm học viên';
      document.getElementById('form-title').innerText = 'Thêm Học viên';
    }

    function showNotification(message, type) {
      const container = document.getElementById('notification-area');
      const alert = document.createElement('div');
      alert.className = `alert alert-${type} alert-dismissible fade show`;
      alert.innerHTML = `${message}<button type="button" class="btn-close" data-bs-dismiss="alert"></button>`;
      container.appendChild(alert);
      setTimeout(() => {
        alert.classList.remove('show');
        setTimeout(() => {
          if (alert.parentElement) container.removeChild(alert);
        }, 200);
      }, 3000);
    }
  </script>
</body>
</html>
